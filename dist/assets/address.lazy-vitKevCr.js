import{z as F,r as g,a2 as A,a3 as S,a4 as t,j as s,aA as b,aB as a,aC as i,aD as n,aE as o,I as c,bP as v,aF as l,B as q,A as m,c as C}from"./index-Bnh7vYvP.js";import{p as E,C as L}from"./profile.service-DWcECk7r.js";const N=t.object({address:t.object({line1:t.string().min(5,{message:"Address Line 1 is required."}),line2:t.string().optional(),cityOrVillage:t.string().min(2,{message:"City or village is required."}),district:t.string().min(2,{message:"District is required."}),state:t.string().min(2,{message:"State is required."}),pincode:t.string().regex(/^\d{6}$/,{message:"Pincode must be 6 digits."})})});function V(){const{user:d}=F(),[j,x]=g.useState(!0),r=A({resolver:S(N),defaultValues:{address:(d==null?void 0:d.address)||{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}},mode:"onChange"});g.useEffect(()=>{d&&(r.reset({address:d.address||{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}}),x(!1))},[d,r]);const f=async e=>{var h,p;try{x(!0),JSON.stringify(e.address)!==JSON.stringify(d==null?void 0:d.address)?(await E.requestUpdate({updates:{address:e.address},type:"SENSITIVE"})).data.success&&m.success("Address update request sent for approval"):m.info("No changes detected in address")}catch(u){const y=u;m.error(((p=(h=y.response)==null?void 0:h.data)==null?void 0:p.message)||"Failed to update address")}finally{x(!1)}};return s.jsx(s.Fragment,{children:j?s.jsx("div",{className:"text-center text-muted-foreground",children:"Loading address details..."}):s.jsx(b,{...r,children:s.jsxs("form",{id:"address-form",onSubmit:r.handleSubmit(f),className:"space-y-8",children:[s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsx(a,{control:r.control,name:"address.line1",render:({field:e})=>s.jsxs(i,{children:[s.jsx(n,{children:"Address Line 1"}),s.jsx(o,{children:s.jsx(c,{...e})}),s.jsx(v,{children:"Address changes require admin approval and can only be updated every 3 months"}),s.jsx(l,{})]})}),s.jsx(a,{control:r.control,name:"address.line2",render:({field:e})=>s.jsxs(i,{children:[s.jsx(n,{children:"Address Line 2"}),s.jsx(o,{children:s.jsx(c,{...e})}),s.jsx(l,{})]})}),s.jsx(a,{control:r.control,name:"address.cityOrVillage",render:({field:e})=>s.jsxs(i,{children:[s.jsx(n,{children:"City/Village"}),s.jsx(o,{children:s.jsx(c,{...e})}),s.jsx(l,{})]})}),s.jsx(a,{control:r.control,name:"address.district",render:({field:e})=>s.jsxs(i,{children:[s.jsx(n,{children:"District"}),s.jsx(o,{children:s.jsx(c,{...e})}),s.jsx(l,{})]})}),s.jsx(a,{control:r.control,name:"address.state",render:({field:e})=>s.jsxs(i,{children:[s.jsx(n,{children:"State"}),s.jsx(o,{children:s.jsx(c,{...e})}),s.jsx(l,{})]})}),s.jsx(a,{control:r.control,name:"address.pincode",render:({field:e})=>s.jsxs(i,{children:[s.jsx(n,{children:"Pincode"}),s.jsx(o,{children:s.jsx(c,{...e})}),s.jsx(l,{})]})})]}),s.jsx(q,{type:"submit",disabled:j,children:"Update address"})]})})})}function I(){return s.jsx(L,{title:"Address Information",desc:"Update your residential address details.",children:s.jsx(V,{})})}const U=C("/dashboard/profile/address")({component:I});export{U as Route};
